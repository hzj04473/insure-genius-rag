{% extends "insurance_app/layouts/base.html" %}
{% load static %}

{% block title %}마이페이지 - 개인정보 관리{% endblock %}

{% block content %}
<div style="max-width: 600px; margin: 0 auto;">
  <!-- 페이지 헤더 -->
  <div class="card" style="margin-bottom: var(--spacing-6);">
    <div class="card-body" style="text-align: center;">
      <div style="width: 60px; height: 60px; background: var(--primary-100); border-radius: var(--radius-2xl); display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-4);">
        <span style="font-size: 24px;">👤</span>
      </div>
      <h1 style="font-size: var(--font-size-3xl); font-weight: var(--font-weight-bold); color: var(--text-primary); margin-bottom: var(--spacing-2);">
        마이페이지
      </h1>
      <p style="color: var(--text-secondary); margin: 0;">
        개인정보를 안전하게 관리하세요
      </p>
    </div>
  </div>

  <!-- 개인 정보 수정 폼 -->
  <div class="card">
    <div class="card-header">
      <h3 style="margin: 0; font-weight: var(--font-weight-bold);">개인 정보 수정</h3>
    </div>
    <div class="card-body">
      <form method="post" autocomplete="off">
        {% csrf_token %}
        
        <!-- 기본 정보 섹션 -->
        <div style="margin-bottom: var(--spacing-6);">
          <h4 style="margin-bottom: var(--spacing-4); color: var(--text-primary); font-weight: var(--font-weight-medium);">기본 정보</h4>
          
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--spacing-4);">
            <!-- 아이디 (읽기 전용) -->
            <div class="form-group">
              <label class="readonly-label">아이디</label>
              <div class="readonly-field">
                {{ user.username }}
              </div>
              <small class="helptext">아이디는 변경할 수 없습니다</small>
            </div>
            
            <!-- 이메일 -->
            <div class="form-group">
              <label class="form-label" for="email">이메일 주소</label>
              <input type="email" id="email" name="email" class="form-input" 
                     value="{{ user.email }}" placeholder="이메일을 입력하세요">
            </div>
            
            <!-- 생년월일 -->
            <div class="form-group">
              <label class="form-label" for="birth_date">생년월일</label>
              <input type="date" id="birth_date" name="birth_date" class="form-input" 
                     value="{% if user.birth_date %}{{ user.birth_date|date:'Y-m-d' }}{% endif %}">
            </div>
            
            <!-- 성별 -->
            <div class="form-group">
              <label class="form-label" for="gender">성별</label>
              <select id="gender" name="gender" class="form-select">
                <option value="">선택하세요</option>
                <option value="M" {% if user.gender == 'M' %}selected{% endif %}>남성</option>
                <option value="F" {% if user.gender == 'F' %}selected{% endif %}>여성</option>
                <option value="O" {% if user.gender == 'O' %}selected{% endif %}>기타</option>
              </select>
            </div>
            
            <!-- 운전면허 -->
            <div class="form-group">
              <label class="form-label" for="has_license">운전면허</label>
              <select id="has_license" name="has_license" class="form-select">
                <option value="false" {% if not user.has_license %}selected{% endif %}>없음</option>
                <option value="true" {% if user.has_license %}selected{% endif %}>있음</option>
              </select>
            </div>
          </div>
        </div>

        <!-- 비밀번호 변경 섹션 -->
        <div style="margin-bottom: var(--spacing-6);">
          <h4 style="margin-bottom: var(--spacing-4); color: var(--text-primary); font-weight: var(--font-weight-medium);">비밀번호 변경 (선택사항)</h4>
          
          <div class="form-group">
            <label class="form-label" for="{{ form.current_password.id_for_label }}">현재 비밀번호</label>
            {{ form.current_password }}
            {% if form.current_password.errors %}
              <div style="color: var(--accent-color); font-size: var(--font-size-sm); margin-top: var(--spacing-1);">
                {{ form.current_password.errors.0 }}
              </div>
            {% endif %}
          </div>

          <div class="form-group">
            <label class="form-label" for="{{ form.new_password1.id_for_label }}">새 비밀번호</label>
            {{ form.new_password1 }}
            {% if form.new_password1.help_text %}
              <div style="color: var(--text-muted); font-size: var(--font-size-sm); margin-top: var(--spacing-1);">
                {{ form.new_password1.help_text|safe }}
              </div>
            {% endif %}
            {% if form.new_password1.errors %}
              <div style="color: var(--accent-color); font-size: var(--font-size-sm); margin-top: var(--spacing-1);">
                {{ form.new_password1.errors.0 }}
              </div>
            {% endif %}
          </div>

          <div class="form-group">
            <label class="form-label" for="{{ form.new_password2.id_for_label }}">새 비밀번호 확인</label>
            {{ form.new_password2 }}
            {% if form.new_password2.errors %}
              <div style="color: var(--accent-color); font-size: var(--font-size-sm); margin-top: var(--spacing-1);">
                {{ form.new_password2.errors.0 }}
              </div>
            {% endif %}
          </div>
        </div>

        <div style="display: flex; gap: var(--spacing-3); justify-content: flex-end; margin-top: var(--spacing-6);">
          <a href="/" class="btn btn-outline">취소</a>
          <button type="submit" class="btn btn-primary">정보 수정</button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}